<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검색 결과</title>
    <link rel="stylesheet" href="/styles/search.css">
    <script>
        async function handleCheckboxChange(photoId, isChecked) {
            try {
                const response = await fetch('/update-like', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        photoId: photoId,
                        action: isChecked ? 'add' : 'remove'
                    })
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.message || 'Error updating like status');
                }
                console.log(result.message);
            } catch (error) {
                console.error('Error:', error);
            }
        }
    </script>
</head>
<body>
    <h1>검색 결과</h1>
    <div class="container">
        <% photos.forEach(function(photo) { %>
            <div class="card">
                <img src="/image/<%= photo.filename %>" alt="<%= photo.filename %>" class="card-img" onclick="window.location.href='/location?address=<%= encodeURIComponent(photo.address) %>&latitude=<%= photo.gps.latitude %>&longitude=<%= photo.gps.longitude %>'">
                <div class="card-body">
                    <h5 class="card-title"><%= photo.filename %></h5>
                    <p class="card-text">
                        주소: <%= photo.address %>
                    </p>
                    <p class="card-text">
                        설명: <%= photo.description || 'No description' %>
                    </p>
                    <div class="card-meta">
                        <p>업로드 시간: <%= photo.uploadDate %></p>
                        <p>좋아요 수: <%= photo.likes %></p>
                        <p>타임스탬프: <%= photo.timestamp %></p>
                        <p>GPS: 위도 <%= photo.gps.latitude %>, 경도 <%= photo.gps.longitude %></p>
                        <!-- Add checkbox for liking the photo -->
                        <label>
                            <input type="checkbox" onchange="handleCheckboxChange('<%= photo._id %>', this.checked)">
                            좋아요
                        </label>
                    </div>
                </div>
            </div>
        <% }); %>
    </div>
</body>
</html>
